angular.module("autoService",["ngRoute","ui.bootstrap"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"frontPage/frontPage.view.html",controller:"frontPageCtrl",controllerAs:"vm"}).when("/services",{templateUrl:"services/services.view.html",controller:"servicesCtrl",controllerAs:"vm"}).when("/inventory",{templateUrl:"inventory/inventory.view.html",controller:"inventoryCtrl",controllerAs:"vm"}).when("/inventory/form",{templateUrl:"inventoryForm/inventoryForm.view.html",controller:"inventoryFormCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/registration",{templateUrl:"/auth/registration/registration.view.html",controller:"registrationCtrl",controllerAs:"vm"}).when("/contact",{templateUrl:"contact/contact.view.html",controller:"contactCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode(!0),t.hashPrefix("")}]),function(){function e(n){return{services:function(e){return e?n.get("/api/services?page="+e):n.get("/api/services")},serviceDelete:function(e){return n.delete("/api/services/"+e)},addNew:function(e){return n.post("/api/services",e)},update:function(e,t){return console.log("test"),n.put("/api/services/"+e,t)}}}e.$inject=["$http"],angular.module("autoService").service("serviceData",e)}(),function(){function e(n,t,e){var o=this;o.title="Services",o.msg="Searching sevices...",o.error="",o.deleteService=function(e,t){n.serviceDelete(e).then(function(e){o.data.services.splice(t,1),o.msg="Service deleted successfully",setTimeout(function(){o.msg=""},3e3)},function(e){o.msg="Delete failed.",setTimeout(function(){o.msg=""},3e3),console.log(e.e)})},o.serviceFormModal=function(e){t.open({templateUrl:"/serviceForm/serviceForm.view.html",controller:"serviceFormCtrl",controllerAs:"vm",resolve:{serviceDetails:function(){return e}}}).result.then(function(e){void 0!==e&&(e.update?(o.msg="Service updated successfully",setTimeout(function(){o.msg=""},3e3)):(o.msg="Service added successfully",setTimeout(function(){o.msg=""},3e3),o.data.services.push(e.data)))},function(e){o.msg="Napaka: "+e})},o.goToNextPage=function(){n.services(o.data.nextPage).then(function(e){o.msg=0<e.data.docs.length?"":"No data in services.",o.data={services:e.data.docs,nextPage:e.data.nextPage,prevPage:e.data.prevPage}},function(e){o.msg="An error occured when fetching data from services.",console.log(e.e)})},o.goToPrevPage=function(){n.services(o.data.prevPage).then(function(e){o.msg=0<e.data.docs.length?"":"No data in services.",o.data={services:e.data.docs,nextPage:e.data.nextPage,prevPage:e.data.prevPage}},function(e){o.msg="An error occured when fetching data from services.",console.log(e.e)})},o.logedin=function(){return e.logedin()},n.services().then(function(e){o.msg=0<e.data.docs.length?"":"No services.",o.data={services:e.data.docs,nextPage:e.data.nextPage,prevPage:e.data.prevPage}},function(e){o.msg="Error while fetching services.",console.log(e.e)})}e.$inject=["serviceData","$uibModal","authentication"],angular.module("autoService").controller("servicesCtrl",e)}(),function(){function e(e,t,n){var o=this;o.title="Services",o.msg="Searching sevices...",o.data=void 0===n?{firstName:"",lastName:"",email:"",phoneNumber:"",time:"",type:""}:n,o.modalnoOkno={preklici:function(){t.close()}},o.saveData=function(){console.log(o.data),void 0===o.data._id?e.addNew(o.data).then(function(e){console.log(e),t.close({data:e.data,update:!1})},function(e){o.msg="Delete failed.",console.log(e.e)}):e.update(o.data._id,o.data).then(function(e){console.log(e),t.close({data:e.data,update:!0})},function(e){o.msg="Delete failed.",console.log(e.e)})}}e.$inject=["serviceData","$uibModalInstance","serviceDetails"],angular.module("autoService").controller("serviceFormCtrl",e)}(),function(){function e(n,t){var o=this;o.title="Inventory",o.msg="Searching inventory data...",o.deleteInventory=function(e,t){n.inventoryDelete(e).then(function(e){o.msg="Item deleted successfully",setTimeout(function(){o.msg=""},3e3),o.data.inventory.splice(t,1)},function(e){o.msg="Failed to delete",console.log(e.e)})},o.inventoryFormModal=function(e){t.open({templateUrl:"/inventoryForm/inventoryForm.view.html",controller:"inventoryFormCtrl",controllerAs:"vm",resolve:{inventoryDetails:function(){return e}}}).result.then(function(e){void 0!==e&&(e.update?(o.msg="Item updated successfully",setTimeout(function(){o.msg=""},3e3)):(o.msg="Item added successfully",setTimeout(function(){o.msg=""},3e3),o.data.inventory.push(e.data)))},function(e){})},o.goToNextPage=function(){n.inventory(o.data.nextPage).then(function(e){o.msg=0<e.data.docs.length?"":"No data in inventory.",o.data={inventory:e.data.docs,nextPage:e.data.nextPage,prevPage:e.data.prevPage}},function(e){o.msg="An error occured when fetching data from inventory.",console.log(e.e)})},o.goToPrevPage=function(){n.inventory(o.data.prevPage).then(function(e){o.msg=0<e.data.docs.length?"":"No data in inventory.",o.data={inventory:e.data.docs,nextPage:e.data.nextPage,prevPage:e.data.prevPage}},function(e){o.msg="An error occured when fetching data from inventory.",console.log(e.e)})},n.inventory().then(function(e){console.log(e),o.msg=0<e.data.docs.length?"":"No data in inventory.",o.data={inventory:e.data.docs,nextPage:e.data.nextPage,prevPage:e.data.prevPage}},function(e){o.msg="An error occured when fetching data from inventory.",console.log(e.e)})}e.$inject=["inventoryData","$uibModal"],angular.module("autoService").controller("inventoryCtrl",e)}(),angular.module("autoService").controller("frontPageCtrl",function(){this.title="Welcome",this.msg="Loading FrontPage",this.error=""}),angular.module("autoService").controller("contactCtrl",function(){this.title="Welcome",this.msg="Loading Contact",this.error=""}),function(){function e(n,o){return{inventory:function(e){return console.log(e),e?n.get("/api/inventory?page="+e,{headers:{Authorization:"Bearer "+o.returnToken()}}):n.get("/api/inventory",{headers:{Authorization:"Bearer "+o.returnToken()}})},inventoryDelete:function(e){return n.delete("/api/inventory/"+e,{headers:{Authorization:"Bearer "+o.returnToken()}})},addNew:function(e){return n.post("/api/inventory",e,{headers:{Authorization:"Bearer "+o.returnToken()}})},update:function(e,t){return console.log("test"),n.put("/api/inventory/"+e,t,{headers:{Authorization:"Bearer "+o.returnToken()}})}}}e.$inject=["$http","authentication"],angular.module("autoService").service("inventoryData",e)}(),function(){function e(e,t,n){var o=this;o.title="Inventory",o.msg="Searching inventory...",o.data=n||{itemName:"",description:"",quantity:""},o.modalnoOkno={preklici:function(){t.close()}},o.saveData=function(){console.log(o.data),void 0===o.data._id?e.addNew(o.data).then(function(e){console.log(e),t.close({data:e.data,update:!1})},function(e){o.msg="Delete failed.",console.log(e.e)}):e.update(o.data._id,o.data).then(function(e){console.log(e),t.close({data:e.data,update:!0})},function(e){o.msg="Delete failed.",console.log(e.e)})}}e.$inject=["inventoryData","$uibModalInstance","inventoryDetails"],angular.module("autoService").controller("inventoryFormCtrl",e)}(),function(){function e(n,t){var o=function(e){n.localStorage["autoService-token"]=e},r=function(){return n.localStorage["autoService-token"]},a=function(){var e=r();return!!e&&JSON.parse(n.atob(e.split(".")[1])).validityDate>Date.now()/1e3};return{storeToken:o,returnToken:r,registration:function(e){return t.post("/api/register",e).then(function(e){o(e.data.token)})},login:function(e){return t.post("/api/login",e).then(function(e){o(e.data.token)})},logout:function(){n.localStorage.removeItem("autoService-token")},logedin:a,currUser:function(){if(a()){var e=r(),t=JSON.parse(n.atob(e.split(".")[1]));return{mail:t.mail,name:t.name}}}}}e.$inject=["$window","$http"],angular.module("autoService").service("authentication",e)}(),function(){function e(t,e){var n=this;n.registerData={name:"",mail:"",pass:"",admin:!1},n.firstToDisplay=t.search().page||"/",n.sendContent=function(){if(n.error="",!(n.registerData.name&&n.registerData.mail&&n.registerData.pass))return!(n.error="Enter all the data!");n.register()},n.register=function(){n.error="",e.registration(n.registerData).then(function(e){t.search("login",null),t.path(n.firstToDisplay)},function(e){n.error=e.data})}}e.$inject=["$location","authentication"],angular.module("autoService").controller("registrationCtrl",e)}(),function(){function e(e,t){var n=this;n.loginData={mail:"",pass:""},n.error="",n.sendContent=function(){if(n.error="",!n.loginData.mail||!n.loginData.pass)return!(n.error="All data required.");n.login()},n.login=function(){n.error="",console.log(n.loginData),e.login(n.loginData).then(function(e){console.log("dela",e),t.path("/inventory")},function(e){n.error=e.data})}}e.$inject=["authentication","$location"],angular.module("autoService").controller("loginCtrl",e)}(),function(){var e=function(e){return this.logedin=function(){return e.logedin()},{restrict:"EA",templateUrl:"/all/directives/nav/nav.template.html"}};e.$inject=["authentication"],angular.module("autoService").directive("naviga",e)}();